# Test Coverage Progress

## Iteration 1
- **Tested**: fingerprint.ts - deduplication produces consistent hashes regardless of timestamps/requestIds
- **Coverage**: 4.15% statements overall, fingerprint.ts at 85.18%
- **Learning**: Set up vitest + v8 coverage. fingerprint has circular ref handler (line 16) and array edge case (line 32) still uncovered - minor internal branches.

## Iteration 2
- **Tested**: config.ts - loadConfigFile correctly parses YAML with teams array
- **Coverage**: 6.14% statements overall, config.ts at 40.74%
- **Learning**: Config loading is user-critical. Still uncovered: tilde expansion, missing file handling, invalid teams validation, loadConfig() with env vars.

## Iteration 3
- **Tested**: db.ts - job lifecycle from insert → claim → complete with accurate stats
- **Coverage**: 11.75% statements overall, db.ts at 70.45%
- **Learning**: Database is the core job queue. Test covers insertJob, claimNextJob, markCompleted, getStats, getJob. Still uncovered: markFailed, markDuplicate, fingerprint operations, dashboard queries.

## Iteration 4
- **Tested**: config.ts - error when user provides explicit config path that doesn't exist
- **Coverage**: 12.29% statements overall, config.ts at 51.85%
- **Learning**: Users will hit this error when they typo a config path. The `isExplicit` flag differentiates user-provided paths (should error) from default paths (silently return null). Still uncovered: loadConfig() env var validation, teams type validation.

## Iteration 5
- **Tested**: config.ts - loadConfig() throws when LINEAR_API_KEY missing
- **Coverage**: 13.2% statements overall, config.ts at 70.37%
- **Learning**: Users hit this on first setup. Required env isolation in test (save/restore process.env). Still uncovered: LINEU_REPO validation, teams type validation error, getDefaultConfigPath/getDefaultDatabasePath.

## Iteration 6
- **Tested**: config.ts - loadConfig() throws when repository path is missing
- **Coverage**: 13.38% statements overall, config.ts at 74.07%
- **Learning**: Common first-run error. Validates both override path and LINEU_REPO env are checked. Still uncovered: teams type validation, default config path not found (returns null), getDefaultConfigPath/getDefaultDatabasePath.

## Iteration 7
- **Tested**: config.ts - loadConfigFile() throws when teams array contains non-string values
- **Coverage**: 13.74% statements overall, config.ts at 81.48%
- **Learning**: Users editing config.yml may accidentally use numbers or other types. This validates the typed teams array. Still uncovered: getDefaultConfigPath/getDefaultDatabasePath (minor utilities), default config not found path (returns null silently).

## Iteration 8
- **Tested**: db.ts - markFailed() records error message for user debugging
- **Coverage**: 13.92% statements overall, db.ts at 72.72%
- **Learning**: When Claude analysis fails (timeout, API error), users need to see why via `lineu stats` or job lookup. Error message and processed_at are preserved. Still uncovered in db.ts: markDuplicate, fingerprint operations, dashboard queries.
